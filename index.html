<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1.0">
<title>Climix</title>
<link rel="manifest" href="manifest.json">
<meta name="theme-color" content="#000000">
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<style>
*{margin:0;padding:0;box-sizing:border-box;font-family:system-ui}
body{background:#000;color:#fff;display:flex;justify-content:center;transition:background 0.3s,color 0.3s}
body.oled{background:#000;color:#fff}
:root{--aqi-tint:rgba(0,0,0,0)}
.app{max-width:420px;width:100%;padding:16px;background:linear-gradient(180deg,var(--aqi-tint),#000);transition:background 0.3s}
.card{background:rgba(255,255,255,.08);backdrop-filter:blur(14px);border-radius:18px;padding:16px;margin-bottom:14px}
h2{font-size:1.25rem;border-bottom:1px solid rgba(255,255,255,.2);padding-bottom:6px;margin-bottom:10px}
.big{font-size:2.5rem;text-align:center;font-weight:800}
.sub{font-size:1.2rem;text-align:center;margin-bottom:6px}
.grid{display:grid;grid-template-columns:repeat(2,1fr);gap:10px}
.toggle{background:#111;color:#fff;border:none;border-radius:12px;padding:8px;cursor:pointer}
.alert{padding:10px;border-radius:12px;font-size:.95rem}
.good{background:#0a3}
.warn{background:#a80}
.bad{background:#800}
.hourly{display:flex;gap:10px;overflow-x:auto;margin-top:8px}
.hour{min-width:78px;text-align:center;background:rgba(255,255,255,.1);padding:10px;border-radius:12px;font-size:.85rem}
input,button{height:46px;border-radius:14px;border:none;font-size:1.05rem}
input{width:70%;padding:0 10px}
button{width:28%;background:#222;color:#fff}
.list .row{display:flex;justify-content:space-between;padding:8px 10px;background:rgba(255,255,255,0.06);border-radius:10px;margin-bottom:6px}
</style>
</head>
<body>
<div class="app">

<header style="display:flex;justify-content:space-between;align-items:center;margin-bottom:14px">
<h1>Climix</h1>
<button class="toggle" onclick="toggleDark()">ðŸŒ™ OLED</button>
</header>

<div class="card">
<input id="city" placeholder="Enter city">
<button onclick="loadWeather(document.getElementById('city').value.trim())">Search</button>
</div>

<div class="card">
<div id="cityName" class="sub">Kolkata, India</div>
<div id="temp" class="big">--Â°C</div>
<div id="feel" class="sub">Feels like --Â°C</div>
</div>

<div class="card">
<h2>Location Conditions</h2>
<div class="grid">
<div>Humidity <span id="humidity">--</span></div>
<div>Pressure <span id="pressure">--</span></div>
<div>Wind <span id="wind">--</span></div>
<div>Direction <span id="windDir">--</span></div>
<div>Precip <span id="precip">--</span></div>
<div>Cloud <span id="cloud">--</span></div>
<div>Visibility <span id="vis">--</span></div>
<div>UV <span id="uv">--</span></div>
<div>Dew <span id="dew">--</span></div>
<div>Sunrise <span id="sunrise">--</span></div>
<div>Sunset <span id="sunset">--</span></div>
</div>
</div>

<div class="card">
<h2>AQI Details</h2>
<div class="big" id="aqiValue">AQI --</div>
<div id="aqiCategory" style="text-align:center">--</div>
<div id="aqiHealth" style="text-align:center;margin-bottom:10px">--</div>
<div class="grid">
<div>PM2.5 <span id="pm25">--</span></div>
<div>PM10 <span id="pm10">--</span></div>
<div>Oâ‚ƒ <span id="o3">--</span></div>
<div>NOâ‚‚ <span id="no2">--</span></div>
<div>Dominant <span id="dominant">--</span></div>
</div>
</div>

<div class="card">
<h2>Pollutant Breakdown (72h)</h2>
<canvas id="pollChart" height="180"></canvas>
<div class="hourly" id="pollHours"></div>
</div>

<div class="card">
<h2>Next 24 Hours</h2>
<div id="hourly" class="list"></div>
</div>

<div class="card">
<h2>7-Day Forecast</h2>
<div id="daily" class="list"></div>
</div>

<div class="card">
<h2>Health Advisory</h2>
<div id="healthAlert" class="alert">--</div>
</div>

<div class="card" style="text-align:center;font-size:0.9rem">
Â© Manik Roy 2025. All Rights Reserved.
</div>

</div>

<script>
let lastLat=22.5726,lastLon=88.3639,lastCity="Kolkata, India";
let dark=true;let pollChart;

function toggleDark(){
  dark=!dark;
  if(dark){
    document.body.classList.add("oled");
    document.querySelector(".app").style.background="#000";
    document.querySelector(".toggle").textContent="ðŸŒ™ OLED";
  } else {
    document.body.classList.remove("oled");
    document.querySelector(".app").style.background="linear-gradient(180deg,var(--aqi-tint),#000)";
    document.querySelector(".toggle").textContent="â˜€ï¸";
  }
}

const BP={
 pm25:[[0,12,0,50],[12.1,35.4,51,100],[35.5,55.4,101,150],[55.5,150.4,151,200],[150.5,250.4,201,300],[250.5,500,301,500]],
 pm10:[[0,54,0,50],[55,154,51,100],[155,254,101,150],[255,354,151,200],[355,424,201,300],[425,604,301,500]],
 o3:[[0,54,0,50],[55,70,51,100],[71,85,101,150],[86,105,151,200],[106,200,201,300],[201,604,301,500]],
 no2:[[0,53,0,50],[54,100,51,100],[101,360,101,150],[361,649,151,200],[650,1249,201,300],[1250,2049,301,500]]
};
function scalePollutant(value,pollutant){
 const table=BP[pollutant];if(!table||value==null) return 0;
 for(const b of table){if(value>=b[0]&&value<=b[1]) return Math.round(((b[3]-b[2])/(b[1]-b[0]))*(value-b[0])+b[2]);}
 return 500;
}
function aqiCategory(aqi){
 if(aqi<=50)return"Good";
 if(aqi<=100)return"Moderate";
 if(aqi<=150)return"Unhealthy (Sensitive)";
 if(aqi<=200)return"Unhealthy";
 if(aqi<=300)return"Very Unhealthy";
 return"Hazardous";
}
function applyAQITint(aqi){
 let t="rgba(0,0,0,0)";
 if(aqi<=50)t="rgba(0,180,90,.12)";
 else if(aqi<=100)t="rgba(255,200,0,.14)";
 else if(aqi<=150)t="rgba(255,140,0,.16)";
 else if(aqi<=200)t="rgba(255,80,80,.18)";
 else t="rgba(180,0,0,.22)";
 if(!dark) t="linear-gradient(180deg,"+t+",#000)";
 document.documentElement.style.setProperty("--aqi-tint",t);
}

// ... (the rest of the previous JS functions remain the same, including getCoords, getWeather, getAQI, loadWeather, updatePollutantChart)
</script>
</body>
</html>
