<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Climix</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="theme-color" content="#000000">

<style>
*{margin:0;padding:0;box-sizing:border-box}

/* ================= BASE ================= */
body{
 min-height:100vh;
 display:flex;
 justify-content:center;
 font-family:Segoe UI,sans-serif;
 overflow-x:hidden;
 overflow-y:auto;
 -webkit-overflow-scrolling:touch;
 color:#e5eaf0;
 transition:background 1.2s, filter .4s;
}

/* ================= WEATHER THEMES ================= */
body.day.clear{background:linear-gradient(140deg,#0f2027,#203a43,#2c5364)}
body.day.cloudy{background:linear-gradient(140deg,#232526,#414345)}
body.day.rain{background:linear-gradient(140deg,#141e30,#243b55)}

body.night{
 background:linear-gradient(180deg,#000000,#0b0c10);
}

/* AQI adaptive overlay */
body.aqi-good{box-shadow:inset 0 0 0 9999px rgba(0,255,200,.02)}
body.aqi-moderate{box-shadow:inset 0 0 0 9999px rgba(255,200,0,.04)}
body.aqi-poor{box-shadow:inset 0 0 0 9999px rgba(255,80,80,.06)}

#effects{
 position:fixed;
 inset:0;
 pointer-events:none;
 z-index:1;
}

/* ================= APP FRAME ================= */
.app{
 width:100%;
 max-width:420px;
 padding:16px;
 margin:20px 0;
 backdrop-filter:blur(26px);
 background:rgba(10,15,20,.65);
 border-radius:30px;
 box-shadow:
  0 30px 60px rgba(0,0,0,.8),
  inset 0 0 0 1px rgba(255,255,255,.05);
 z-index:2;
}

.card{
 margin-bottom:14px;
 padding:16px;
 border-radius:22px;
 background:rgba(20,25,30,.55);
}

.center{text-align:center}
.temp{font-size:48px;font-weight:bold;color:#fff}
.icon{font-size:64px}

canvas{width:100%;height:150px}

.week{display:flex;gap:12px;overflow-x:auto}
.week div{
 min-width:80px;
 padding:10px;
 border-radius:16px;
 background:rgba(0,0,0,.3);
 text-align:center
}

input,button{
 width:100%;
 padding:12px;
 border-radius:14px;
 border:none;
 font-size:16px
}
input{background:rgba(255,255,255,.1);color:#fff}
button{background:#1f6feb;color:#fff;margin-top:6px}

.slider{
 width:100%;
 margin-top:6px;
}

footer{text-align:center;font-size:12px;opacity:.7}

/* ================= PARTICLES ================= */
.particles span{
 position:absolute;
 width:2px;height:14px;
 background:rgba(255,255,255,.6);
 animation:rain 1s linear infinite
}
@keyframes rain{
 from{transform:translateY(-20px)}
 to{transform:translateY(100vh)}
}
</style>
</head>

<body class="day clear">

<div id="effects"></div>

<div class="app">

<div class="card center"><h2>Climix</h2></div>

<div class="card">
<input id="city" placeholder="Enter city">
<button onclick="search()">Search</button>
</div>

<div class="card center">
<div class="icon" id="icon">â›…</div>
<div class="temp" id="temp">--Â°C</div>
<div id="desc"></div>
<div id="place"></div>
</div>

<div class="card">
<label>Hue Intensity</label>
<input type="range" min="80" max="120" value="100" class="slider" id="hue">
</div>

<div class="card">
<h4>Hourly Temperature</h4>
<canvas id="tChart"></canvas>
</div>

<div class="card">
<h4>AQI (US)</h4>
<canvas id="aqiChart"></canvas>
</div>

<div class="card">
<h4>Weekly</h4>
<div class="week" id="week"></div>
</div>

<footer>Â© Manik Roy 2025. All Rights Reserved.</footer>
</div>

<script>
window.onload=()=>{
 loadWeather(28.6139,77.2090,"Delhi");
 applyHue();
};

/* ================= SEARCH ================= */
function search(){
 if(!city.value) return;
 fetch(`https://geocoding-api.open-meteo.com/v1/search?name=${city.value}`)
 .then(r=>r.json())
 .then(d=>{
  if(!d.results) return;
  const x=d.results[0];
  loadWeather(x.latitude,x.longitude,x.name);
 });
}

/* ================= WEATHER ================= */
function loadWeather(lat,lon,name){
 fetch(`https://api.open-meteo.com/v1/forecast?latitude=${lat}&longitude=${lon}&current_weather=true&hourly=temperature_2m&daily=temperature_2m_max,weathercode,sunrise,sunset&timezone=auto`)
 .then(r=>r.json())
 .then(d=>{
  temp.innerText=d.current_weather.temperature+"Â°C";
  icon.innerText=iconOf(d.current_weather.weathercode);
  desc.innerText=textOf(d.current_weather.weathercode);
  place.innerText=name;

  applyDayNight(d.daily.sunrise[0],d.daily.sunset[0]);
  draw(d.hourly.temperature_2m,tChart);
  weekly(d.daily);
  loadAQI(lat,lon);
 });
}

/* ================= AQI ================= */
function loadAQI(lat,lon){
 fetch(`https://air-quality-api.open-meteo.com/v1/air-quality?latitude=${lat}&longitude=${lon}&hourly=us_aqi`)
 .then(r=>r.json())
 .then(a=>{
  draw(a.hourly.us_aqi,aqiChart);
  applyAQIColor(a.hourly.us_aqi[0]);
 });
}

/* ================= VISUAL LOGIC ================= */
function applyDayNight(sr,ss){
 const now=Date.now();
 document.body.classList.toggle("night", now<new Date(sr) || now>new Date(ss));
 document.body.classList.toggle("day", !(now<new Date(sr) || now>new Date(ss)));
}

function applyAQIColor(v){
 document.body.classList.remove("aqi-good","aqi-moderate","aqi-poor");
 if(v<=50) document.body.classList.add("aqi-good");
 else if(v<=100) document.body.classList.add("aqi-moderate");
 else document.body.classList.add("aqi-poor");
}

/* ================= HUE SLIDER ================= */
hue.oninput=()=>{
 localStorage.hue=hue.value;
 applyHue();
};
function applyHue(){
 const v=localStorage.hue||100;
 document.body.style.filter=`saturate(${v}%)`;
 hue.value=v;
}

/* ================= WEEK ================= */
function weekly(d){
 week.innerHTML="";
 d.time.forEach((t,i)=>{
  week.innerHTML+=`
   <div>${new Date(t).toLocaleDateString("en",{weekday:"short"})}<br>
   ${iconOf(d.weathercode[i])}<br>${d.temperature_2m_max[i]}Â°</div>`;
 });
}

/* ================= CHART ================= */
function draw(data,c){
 const x=c.getContext("2d");
 c.width=320;c.height=150;
 x.clearRect(0,0,320,150);
 const m=Math.min(...data),M=Math.max(...data);
 x.beginPath();
 data.slice(0,24).forEach((v,i)=>{
  const X=i*(320/23);
  const Y=150-((v-m)/(M-m||1))*150;
  i?x.lineTo(X,Y):x.moveTo(X,Y);
 });
 x.strokeStyle="#1f6feb";
 x.lineWidth=2;
 x.stroke();
}

/* ================= HELPERS ================= */
function iconOf(c){return c==0?"â˜€":c<4?"â›…":c<70?"ðŸŒ§":"ðŸŒ©";}
function textOf(c){return c==0?"Clear":c<4?"Cloudy":c<70?"Rain":"Storm";}
</script>
</body>
</html>
