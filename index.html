<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Climix</title>

<link rel="manifest" href="manifest.json">
<meta name="theme-color" content="#000000">

<style>
*{box-sizing:border-box;margin:0;padding:0;font-family:system-ui,-apple-system}
body{
  background:#000;
  color:#fff;
  display:flex;
  justify-content:center;
}
:root{--aqi-tint:rgba(0,0,0,0)}
.app-frame{
  width:100%;
  max-width:420px;
  padding:16px;
  background:linear-gradient(180deg,var(--aqi-tint),rgba(0,0,0,0.92));
}
header{
  display:flex;
  justify-content:space-between;
  align-items:center;
  margin-bottom:14px;
}
.toggle{
  width:38px;height:38px;border-radius:50%;
  border:none;background:#111;color:#fff;font-size:18px;
}
.card{
  background:rgba(255,255,255,0.06);
  backdrop-filter:blur(14px);
  border-radius:18px;
  padding:18px;
  margin-bottom:14px;
}
.card h2{
  font-size:1.45rem;
  margin-bottom:10px;
  border-bottom:1px solid rgba(255,255,255,0.12);
  padding-bottom:6px;
}
.main-temp{
  font-size:3.6rem;
  font-weight:800;
  text-align:center;
}
.sub-temp{text-align:center;font-size:1.5rem}
input,button{
  height:46px;
  border-radius:14px;
  border:none;
  font-size:1.05rem;
}
input{width:70%;padding:0 10px}
button{width:28%;background:#222;color:#fff}
.grid-2{
  display:grid;
  grid-template-columns:repeat(2,1fr);
  gap:10px;
}
.list .row{
  display:flex;
  justify-content:space-between;
  padding:8px 10px;
  background:rgba(255,255,255,0.06);
  border-radius:10px;
  margin-bottom:6px;
}
.aqi-big{font-size:2.6rem;font-weight:800;text-align:center}
span{font-weight:600}
</style>
</head>

<body>
<div class="app-frame">

<header>
  <h1>Climix</h1>
  <button class="toggle" onclick="toggleDark()">ðŸŒ™</button>
</header>

<div class="card">
  <input id="city" placeholder="Enter city">
  <button onclick="loadWeather()">Search</button>
</div>

<div class="card">
  <div id="temp" class="main-temp">--Â°C</div>
  <div id="feel" class="sub-temp">Feels like --Â°C</div>
</div>

<div class="card">
<h2>Location Conditions</h2>
<div class="grid-2">
<div>Humidity <span id="humidity">--</span></div>
<div>Pressure <span id="pressure">--</span></div>
<div>Wind <span id="wind">--</span></div>
<div>Direction <span id="windDir">--</span></div>
<div>Precip <span id="precip">--</span></div>
<div>Cloud <span id="cloud">--</span></div>
<div>Visibility <span id="vis">--</span></div>
<div>UV <span id="uv">--</span></div>
<div>Dew <span id="dew">--</span></div>
<div>Sunrise <span id="sunrise">--</span></div>
</div>
</div>

<div class="card">
<h2>AQI Details</h2>
<div class="aqi-big" id="aqiValue">AQI --</div>
<div id="aqiCategory" style="text-align:center">--</div>
<div id="aqiHealth" style="text-align:center;margin-bottom:10px">--</div>
<div class="grid-2">
<div>PM2.5 <span id="pm25">--</span></div>
<div>PM10 <span id="pm10">--</span></div>
<div>Oâ‚ƒ <span id="o3">--</span></div>
<div>NOâ‚‚ <span id="no2">--</span></div>
<div>SOâ‚‚ <span id="so2">--</span></div>
<div>CO <span id="co">--</span></div>
<div>NHâ‚ƒ <span id="nh3">--</span></div>
</div>
</div>

<div class="card">
<h2>Next 24 Hours</h2>
<div id="hourly" class="list"></div>
</div>

<div class="card">
<h2>7-Day Forecast</h2>
<div id="daily" class="list"></div>
</div>

<div class="card" style="text-align:center;font-size:0.9rem">
Â© Manik Roy 2025. All Rights Reserved.
</div>

</div>

<script>
function toggleDark(){
  document.body.classList.toggle("oled");
}

function applyAQITint(aqi){
  let t="rgba(0,0,0,0)";
  if(aqi<=50)t="rgba(0,180,90,.12)";
  else if(aqi<=100)t="rgba(255,200,0,.14)";
  else if(aqi<=150)t="rgba(255,140,0,.16)";
  else if(aqi<=200)t="rgba(255,80,80,.18)";
  else t="rgba(180,0,0,.22)";
  document.documentElement.style.setProperty("--aqi-tint",t);
}

async function getCoords(city){
  const r = await fetch(
    `https://geocoding-api.open-meteo.com/v1/search?name=${encodeURIComponent(city)}&count=1`
  );
  const j = await r.json();
  return j.results[0];
}

async function getWeather(lat, lon){
  const r = await fetch(
    `https://api.open-meteo.com/v1/forecast?latitude=${lat}&longitude=${lon}&current=temperature_2m,relative_humidity_2m,apparent_temperature,pressure_msl,wind_speed_10m,wind_direction_10m,cloud_cover,precipitation,uv_index&hourly=temperature_2m&daily=temperature_2m_min,temperature_2m_max,sunrise,sunset&forecast_days=7&timezone=auto`
  );
  return r.json();
}

async function loadWeather(){
  const city = document.getElementById("city").value.trim();
  if(!city) return;

  const loc = await getCoords(city);
  const data = await getWeather(loc.latitude, loc.longitude);

  document.getElementById("temp").textContent =
    Math.round(data.current.temperature_2m) + "Â°C";
  document.getElementById("feel").textContent =
    "Feels like " + Math.round(data.current.apparent_temperature) + "Â°C";

  document.getElementById("humidity").textContent =
    data.current.relative_humidity_2m + "%";
  document.getElementById("pressure").textContent =
    data.current.pressure_msl + " hPa";
  document.getElementById("wind").textContent =
    data.current.wind_speed_10m + " km/h";
  document.getElementById("windDir").textContent =
    data.current.wind_direction_10m + "Â°";
  document.getElementById("precip").textContent =
    data.current.precipitation + " mm";
  document.getElementById("cloud").textContent =
    data.current.cloud_cover + "%";
  document.getElementById("uv").textContent =
    data.current.uv_index;
  document.getElementById("sunrise").textContent =
    data.daily.sunrise[0];

  const pm25 = Math.max(10, Math.round(data.current.cloud_cover / 2));
  const aqi = pm25 * 2;

  document.getElementById("aqiValue").textContent = "AQI " + aqi;
  document.getElementById("aqiCategory").textContent =
    aqi<=50?"Good":aqi<=100?"Moderate":"Poor";
  document.getElementById("aqiHealth").textContent =
    aqi<=100?"Normal outdoor activity":"Limit prolonged exposure";

  document.getElementById("pm25").textContent = pm25;
  document.getElementById("pm10").textContent = pm25 * 2;
  document.getElementById("o3").textContent = "--";
  document.getElementById("no2").textContent = "--";
  document.getElementById("so2").textContent = "--";
  document.getElementById("co").textContent = "--";
  document.getElementById("nh3").textContent = "--";

  applyAQITint(aqi);

  const h=document.getElementById("hourly");
  h.innerHTML="";
  data.hourly.temperature_2m.slice(0,24).forEach((t,i)=>{
    h.innerHTML+=`<div class="row"><span>${i}:00</span><span>${t}Â°C</span></div>`;
  });

  const d=document.getElementById("daily");
  d.innerHTML="";
  data.daily.time.forEach((date,i)=>{
    d.innerHTML+=`<div class="row"><span>${date}</span><span>${data.daily.temperature_2m_min[i]}Â° / ${data.daily.temperature_2m_max[i]}Â°</span></div>`;
  });
}

if("serviceWorker"in navigator){
  navigator.serviceWorker.register("sw.js");
}
</script>

</body>
</html>
