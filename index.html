<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Climix Base</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
  body {
    margin:0; padding:0;
    font-family: system-ui,-apple-system,Segoe UI;
    background: linear-gradient(145deg,#050b18,#081a2e,#0a2236);
    color: #eaf1ff;
    display: flex;
    justify-content: center;
    min-height: 100vh;
  }
  .app {
    width: 100%;
    max-width: 420px;
    padding: 16px;
    margin: 16px;
    border-radius: 28px;
    background: rgba(10,16,30,.85);
    backdrop-filter: blur(28px);
  }
  .card {
    background: rgba(25,35,55,.55);
    border-radius: 20px;
    padding: 14px;
    margin-bottom: 12px;
  }
  .center { text-align: center; }
  input, button { width: 100%; padding: 12px; border-radius: 14px; border: none; margin-top: 6px; }
  button { background: #1f6feb; color:#fff; font-weight:600; cursor:pointer; }
  #modeBtn { width: 44px; height: 44px; border-radius: 50%; font-size: 18px; margin-bottom:10px; }
</style>
</head>
<body>
<div class="app">
  <div class="center">
    <button id="modeBtn">üåô</button>
    <h2>Climix</h2>
  </div>

  <div class="card">
    <input id="city" placeholder="Enter city">
    <button onclick="searchCity()">Search</button>
  </div>

  <div class="card center">
    <h3>Current Temperature</h3>
    <div id="temp">--¬∞C</div>
    <div id="place">Ready</div>
  </div>

  <div class="card center">
    <h3>Rain / Precipitation</h3>
    <div id="rain">-- mm / --%</div>
  </div>

  <div class="card center">
    <h3>Air Quality (AQI)</h3>
    <div id="aqi">--</div>
  </div>
</div>

<script>
const modeBtn = document.getElementById('modeBtn');
modeBtn.onclick = () => {
  document.body.classList.toggle('dark');
  modeBtn.innerText = document.body.classList.contains('dark') ? '‚òÄÔ∏è' : 'üåô';
};

async function fetchJSON(url, fallback) {
  try {
    const res = await fetch(url);
    if(!res.ok) throw new Error("Network error");
    return await res.json();
  } catch(e) {
    console.warn(e);
    return fallback;
  }
}

async function searchCity() {
  const cityName = document.getElementById('city').value;
  if(!cityName) return;
  // Geocoding API
  const geo = await fetchJSON(`https://geocoding-api.open-meteo.com/v1/search?name=${cityName}`, {results:[{latitude:28.6139, longitude:77.209, name:'Delhi'}]});
  const loc = geo.results[0];
  loadWeather(loc.latitude, loc.longitude, loc.name);
}

async function loadWeather(lat, lon, name) {
  place.innerText = name;
  temp.innerText = 'Loading...';
  rain.innerText = '-- mm / --%';
  aqi.innerText = '--';

  // Weather
  const weather = await fetchJSON(`https://api.open-meteo.com/v1/forecast?latitude=${lat}&longitude=${lon}&current_weather=true&hourly=precipitation,precipitation_probability&timezone=auto`, {
    current_weather: {temperature:25},
    hourly: {precipitation:[0], precipitation_probability:[0]}
  });
  temp.innerText = weather.current_weather.temperature + "¬∞C";
  rain.innerText = weather.hourly.precipitation[0]+" mm / "+weather.hourly.precipitation_probability[0]+"%";

  // AQI
  const aqiData = await fetchJSON(`https://air-quality-api.open-meteo.com/v1/air-quality?latitude=${lat}&longitude=${lon}&hourly=us_aqi`, {
    hourly: {us_aqi:[50]}
  });
  aqi.innerText = aqiData.hourly.us_aqi[0];
}

// Initial load
loadWeather(28.6139,77.209,"Delhi");
</script>
</body>
</html>
